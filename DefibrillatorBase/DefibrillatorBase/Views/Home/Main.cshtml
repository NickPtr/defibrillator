
@{
    ViewBag.Title = "Main";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@if (!User.Identity.IsAuthenticated)
{
    <h2>Πρέπει να συνδεθείτε πρώτα για την εμφάνιση της σελίδας!</h2>
    @Html.ActionLink("Σύνδεση", "RedirectToAspx", "Home", new { area = "" }, null)
}
else
{
    <div>
        <div class="section no-pad-bot" id="index-banner">
            <div class="container">
                <div class="valign-wrapper">
                    <div id="mapDiv" style="height: 400px; width: 1280px;"></div>
                </div>
                <div class="row center">
                    <table id="result">
                        <tbody></tbody>
                    </table>
                </div>
                <br/><br/>
            </div>
        </div>
    </div>

    <script>
      
            var list = @Html.Raw(Json.Encode(Model));
            var table = document.getElementById("result");
            var header = table.createTHead();
            var row = header.insertRow(0);
            var hcell1 = row.insertCell(0);
            var hcell2 = row.insertCell(1);
            var hcell3 = row.insertCell(2);
            var hcell4 = row.insertCell(3);
            var hcell5 = row.insertCell(4);
            hcell1.innerHTML = "<b>Όνομα</b>";
            hcell2.innerHTML = "<b>Περιγραφή</b>";
            hcell3.innerHTML = "<b>Τοποθεσία στον χάρτη</b>";
            hcell4.innerHTML = "<b>Βλάβη (Αν υπάρχει)</b>";
            hcell5.innerHTML = "<b>Σχόλια</b>";
       
            for (var i = 0; i < list.length; i++) {
                var row = table.getElementsByTagName('tbody')[0].insertRow(i);
                var cell1 = row.insertCell(0);
                var cell2 = row.insertCell(1);
                var cell3 = row.insertCell(2);
                var cell4 = row.insertCell(3);
                var cell5 = row.insertCell(4);
                cell1.innerHTML = list[i].Name;
                cell2.innerHTML = list[i].Description;
                cell3.innerHTML = list[i].Posx+ " "+ list[i].Posy ;
                cell4.innerHTML = list[i].ErrorStatus;
                cell5.innerHTML = list[i].Elses;
            }
        
      

    </script>
    <script>
       
        var def = @Html.Raw(Json.Encode(Model));
        // position we will use later

        var lat = 37.7932201;
        var lon = 26.6880529;
        // initialize map
        map = L.map('mapDiv').setView([lat, lon], 17);
        // set map tiles source
        L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png',
            {
                attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors',
                maxZoom: 18,
            }).addTo(map);
        var marker = L.marker([def[0].Posx, def[0].Posy]).addTo(map);
        for (var i = 0; i < def.length; i++) {
            var marker = L.marker([def[i].Posx, def[i].Posy]).addTo(map);
            marker.bindPopup(def[i].Name).openPopup();
        }

        // add popup to the marke
    </script>

    <script>
        function Start() {
            var table = document.getElementById("result");
            var body = table.getElementsByTagName("tbody")[0];
            body.length = 0;
            Load();
        }
    </script>

}



